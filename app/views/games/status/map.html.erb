<% tile_count_y = 18 %>
<% tile_count_x = 27 %>

<div data-controller="music">
  <audio src="/Room-music.mp3" loop='true' data-music-target='audio'></audio>
  <button class="btn back" data-action='click->music#play' data-music-target='playButton'><i class="fa-solid fa-volume-xmark"></i></button>
  <button class="btn back" data-action='click->music#pause' data-music-target='pauseButton' hidden><i class="fa-solid fa-volume-high"></i></button>
</div>

<div class="map"
  data-controller="map"
  data-map-user-position-x-value="<%= @game.user_position_x %>"
  data-map-user-position-y-value="<%= @game.user_position_y %>"
  data-map-map-position-x-min-value="1"
  data-map-map-position-x-max-value="<%= tile_count_x %>"
  data-map-map-position-y-min-value="1"
  data-map-map-position-y-max-value="<%= tile_count_y %>"
  >
  <% tile_count_y.times do |y| %>
    <% tile_count_x.times do |x| %>
      <% position = "#{x + 1}-#{y + 1}" %>
      <div class ="tile"
        id="<%=position%>"
        <% if @obstacle_positions.include?(position) %>
          data-map-target="obstacle"
        <% end %>
        >

        <% if @teachers_per_position.key?(position) %>
          <%= cl_image_tag @teachers_per_position[position].avatar_map.key, width: 45, height: 93, class: "teacher" %>
          <%#= image_tag "jeremystatic.png", width: 48, height: 96, class: "teacher" %>
        <% end %>
        <% if @user_position == position %>
          <%= image_tag "userstatic.png", width: 45, height: 93, class: "user", data: {'map-target': 'user'}%>
        <% end %>
      </div>
    <% end %>
  <% end %>
</div>
