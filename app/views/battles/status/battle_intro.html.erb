<div data-controller="music">
  <% if @battle.teacher.status == "tutorial" %>
    <audio src="/Slackbot_Battle.mp3" loop='true' data-music-target='audio'></audio>
  <% elsif @battle.teacher.status == "regular" %>
    <audio src="/Jeremy_Battle.mp3" loop='true' data-music-target='audio'></audio>
  <% elsif @battle.teacher.status == "secret_boss" %>
    <audio src="/Secret_Boss.mp3" loop='true' data-music-target='audio'></audio>
  <% end %>
  <button class="btn back" data-action='click->music#play' data-music-target='playButton'><i class="fa-solid fa-volume-xmark"></i></button>
  <button class="btn back" data-action='click->music#pause' data-music-target='pauseButton' hidden><i class="fa-solid fa-volume-high"></i></button>
</div>

<div data-controller="game" class="battle-background" style="background-image: url('<%= image_path "background-plain.png" %>')">
  <div class="teacher-character">
    <div class="teacher-infos">
      <div><%= @battle.teacher.name %></div>
      <% if @battle.hp_teacher > 4 %>
          <div>HP: <span class="hp-number"><%= @battle.hp_teacher %></span></div>
        <% else %>
          <div>HP: <span class="hp-number-low"><%= @battle.hp_teacher %></span></div>
        <% end %>
    </div>
    <% if @battle.teacher.status == "tutorial" %>
      <%= cl_image_tag @battle.teacher.avatar_battle.key, class: 'enemy-image' %>
    <% else  %>
      <%= cl_image_tag @battle.teacher.avatar_battle.key, class: 'enemy-image-mini' %>
    <% end %>
  </div>
  <div class="stand-teacher">
    <%= image_tag "socle-teacher.png" %>
  </div>

  <div class="stand-user">
    <%= image_tag "socle-user.png" %>
  </div>
  <div class="user-character">
      <div class="user-infos">
        <div><%= @game.user.username %></div>
        <% if @battle.teacher.status == "tutorial" %>
        <% elsif @battle.hp_user > 4 %>
          <div>HP: <span class="hp-number"><%= @battle.hp_user %></span></div>
        <% else %>
          <div>HP: <span class="hp-number-low"><%= @battle.hp_user %></span></div>
        <% end %>
      </div>
    <%= image_tag "back-user.png" %>
  </div>
  <div class="dialog-box">
    <%= "#{@battle.teacher.name} is challenging you to a flashcard battle !" %>
    <%= link_to continue_game_path(@game), data: { turbo_method: :patch, action: "click->game#continue", game_target: "continueLink" } do %>
      <i class="fa-regular fa-lg fa-square-caret-down"></i>
    <% end %>
  </div>
</div>
